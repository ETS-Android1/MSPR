
> api-rest@0.0.0 test C:\Users\Seb\Workspace\MSPR\api-rest
> mocha 'test/**/*.js' --recursive --full-trace --color --timeout 60000 --exit


[0m[0m
[0m  check promoDto integrity[0m
  [32m  âˆš[0m[90m should return true if promo date is valid[0m
  [32m  âˆš[0m[90m should return false if promo date is not valid[0m

[0m  checks routes for client[0m
[34m âš¡  Connection has been established successfully. âš¡
[34m âš¡  Connection has been established successfully. âš¡
[0mGET /clients/1 [32m200 [0m29.424 ms - 204[0m
  [32m  âˆš[0m[90m should send a response with code 200 and the right client in payload if he exists in db[0m[33m (53ms)[0m
[0mGET /clients/10000 [32m204 [0m3.316 ms - -[0m
  [31m  1) should send a response with code 204 and error in payload if he doesnt exist in db[0m
[0mGET /clients/crocodile [32m204 [0m2.394 ms - -[0m
  [31m  2) should send a response with code 404 and error in payload if id is not a number[0m

[0m  checks routes for login[0m
[0mPOST /login/ [32m200 [0m106.780 ms - 204[0m
  [32m  âˆš[0m[90m should send a response with code 200 and the right client in payload if credentials are ok[0m[31m (111ms)[0m
[0mPOST /login/ [33m400 [0m0.438 ms - 26[0m
  [32m  âˆš[0m[90m should send a response with code 400 and error in payload if there is missing parameter[0m
[0mPOST /login/ [33m403 [0m2.428 ms - 37[0m
  [32m  âˆš[0m[90m should send a response with code 403 and error in payload if email doesn't exist[0m
[0mPOST /login/ [33m403 [0m87.778 ms - 37[0m
  [32m  âˆš[0m[90m should send a response with code 404 and error in payload if password doesn't match a right email[0m[31m (91ms)[0m

[0m  checks routes for promos[0m
[0mGET /promos/1 [32m200 [0m3.862 ms - 130[0m
  [32m  âˆš[0m[90m should send a response with code 200 and the right promo in payload if it exists in db[0m
[0mGET /promos/10000 [33m404 [0m2.075 ms - 26[0m
  [31m  3) should send a response with code 204 and error in payload if he doesnt exist in db[0m
[0mGET /promos/crocodile [33m404 [0m1.896 ms - 26[0m
  [32m  âˆš[0m[90m should send a response with code 404 and error in payload if id is not a number[0m
[0mGET /promos/1/2 [33m404 [0m287.895 ms - 2282[0m
  [31m  4) should send a response with code 201 and one the good promo in payload[0m

[0m  check clientDto integrity[0m
  [32m  âˆš[0m[90m should init clientDto with promoDto from clientDao with a promo[0m
  [32m  âˆš[0m[90m should init clientDto with no promoDto from clientDao with no promo[0m


[92m [0m[32m 11 passing[0m[90m (749ms)[0m
[31m  4 failing[0m

[0m  1) checks routes for client
       should send a response with code 204 and error in payload if he doesnt exist in db:
[0m[31m     Uncaught AssertionError: expected {} to have property 'error'[0m[90m
      at chai.request.get.end (C:\Users\Seb\Workspace\MSPR\api-rest\test\controller\clientController.test.js:31:31)
      at Test.Request.callback (C:\Users\Seb\Workspace\MSPR\api-rest\node_modules\superagent\lib\node\index.js:716:12)
      at IncomingMessage.parser (C:\Users\Seb\Workspace\MSPR\api-rest\node_modules\superagent\lib\node\index.js:916:18)
      at IncomingMessage.emit (events.js:194:15)
      at endReadableNT (_stream_readable.js:1125:12)
      at process._tickCallback (internal/process/next_tick.js:63:19)
[0m
[0m  2) checks routes for client
       should send a response with code 404 and error in payload if id is not a number:

      [31mUncaught AssertionError: expected { Object (_events, _eventsCount, ...) } to have status code 404 but got 204[0m
      [32m+ expected[0m [31m- actual[0m

      [31m-204[0m
      [32m+404[0m
      [0m[90m
      at chai.request.get.end (C:\Users\Seb\Workspace\MSPR\api-rest\test\controller\clientController.test.js:38:26)
      at Test.Request.callback (C:\Users\Seb\Workspace\MSPR\api-rest\node_modules\superagent\lib\node\index.js:716:12)
      at IncomingMessage.parser (C:\Users\Seb\Workspace\MSPR\api-rest\node_modules\superagent\lib\node\index.js:916:18)
      at IncomingMessage.emit (events.js:194:15)
      at endReadableNT (_stream_readable.js:1125:12)
      at process._tickCallback (internal/process/next_tick.js:63:19)
[0m
[0m  3) checks routes for promos
       should send a response with code 204 and error in payload if he doesnt exist in db:

      [31mUncaught AssertionError: expected { Object (_events, _eventsCount, ...) } to have status code 204 but got 404[0m
      [32m+ expected[0m [31m- actual[0m

      [31m-404[0m
      [32m+204[0m
      [0m[90m
      at chai.request.get.end (C:\Users\Seb\Workspace\MSPR\api-rest\test\controller\promoController.test.js:26:26)
      at Test.Request.callback (C:\Users\Seb\Workspace\MSPR\api-rest\node_modules\superagent\lib\node\index.js:716:12)
      at parser (C:\Users\Seb\Workspace\MSPR\api-rest\node_modules\superagent\lib\node\index.js:916:18)
      at IncomingMessage.res.on (C:\Users\Seb\Workspace\MSPR\api-rest\node_modules\superagent\lib\node\parsers\json.js:19:7)
      at IncomingMessage.emit (events.js:194:15)
      at endReadableNT (_stream_readable.js:1125:12)
      at process._tickCallback (internal/process/next_tick.js:63:19)
[0m
[0m  4) checks routes for promos
       should send a response with code 201 and one the good promo in payload:

      [31mUncaught AssertionError: expected { Object (_events, _eventsCount, ...) } to have status code 201 but got 404[0m
      [32m+ expected[0m [31m- actual[0m

      [31m-404[0m
      [32m+201[0m
      [0m[90m
      at chai.request.get.end (C:\Users\Seb\Workspace\MSPR\api-rest\test\controller\promoController.test.js:42:26)
      at Test.Request.callback (C:\Users\Seb\Workspace\MSPR\api-rest\node_modules\superagent\lib\node\index.js:716:12)
      at IncomingMessage.parser (C:\Users\Seb\Workspace\MSPR\api-rest\node_modules\superagent\lib\node\index.js:916:18)
      at IncomingMessage.emit (events.js:194:15)
      at endReadableNT (_stream_readable.js:1125:12)
      at process._tickCallback (internal/process/next_tick.js:63:19)
[0m


